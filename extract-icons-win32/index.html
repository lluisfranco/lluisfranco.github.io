<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Extract extra large icon from a file, folder or drive - &gt;_lluis franco</title><meta name="Description" content="home/lluisfranco/code/tips/"><meta property="og:title" content="Extract extra large icon from a file, folder or drive" />
<meta property="og:description" content="Extracting system icons from Win32 Overwiew Hi, everyone! :)
In a recent project I was required to show a list of files with their associated icons. It doesn&rsquo;t sounds quite difficult, and in fact it is not. Except if you have to deal with files in network paths or you want to get different icons sizes, apart the typical 32×32. And well, that was the case :(fas fa-grin-beam-sweat):
If you only need local files and sizes of 32x32 píxels you can achieve this using the static method ExtractAssociatedIcon in the class System." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lluisfranco.com/extract-icons-win32/" />
<meta property="article:published_time" content="2014-04-16T11:51:50+02:00" />
<meta property="article:modified_time" content="2014-04-16T11:51:50+02:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Extract extra large icon from a file, folder or drive"/>
<meta name="twitter:description" content="Extracting system icons from Win32 Overwiew Hi, everyone! :)
In a recent project I was required to show a list of files with their associated icons. It doesn&rsquo;t sounds quite difficult, and in fact it is not. Except if you have to deal with files in network paths or you want to get different icons sizes, apart the typical 32×32. And well, that was the case :(fas fa-grin-beam-sweat):
If you only need local files and sizes of 32x32 píxels you can achieve this using the static method ExtractAssociatedIcon in the class System."/>
<meta name="application-name" content="&gt;_lluis franco">
<meta name="apple-mobile-web-app-title" content="&gt;_lluis franco"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/myAvatar.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://lluisfranco.com/extract-icons-win32/" /><link rel="prev" href="https://lluisfranco.com/mvp-site-interview/" /><link rel="next" href="https://lluisfranco.com/remove-diacritics-in-strings/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Extract extra large icon from a file, folder or drive",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/lluisfranco.com\/extract-icons-win32\/"
        },"genre": "posts","keywords": "csharp, net framework, API, Win32","wordcount":  1144 ,
        "url": "https:\/\/lluisfranco.com\/extract-icons-win32\/","datePublished": "2014-04-16T11:51:50+02:00","dateModified": "2014-04-16T11:51:50+02:00","publisher": {
            "@type": "Organization",
            "name": "Lluis Franco"},"author": {
                "@type": "Person",
                "name": "lluís"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="&gt;_lluis franco"><span class="header-title-pre"><i class='fas fa-terminal'></i></span>lluis franco</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/about/"> About </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/extract-icons-win32/" selected>English</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="&gt;_lluis franco"><span class="header-title-pre"><i class='fas fa-terminal'></i></span>lluis franco</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/about/" title="">About</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="Select Language">English<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/extract-icons-win32/" selected>English</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Extract extra large icon from a file, folder or drive</h1><h2 class="single-subtitle">Including network paths! :)</h2><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/about/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>lluís</a></span>&nbsp;<span class="post-category">included in <a href="/categories/development/"><i class="far fa-folder fa-fw"></i>Development</a>&nbsp;<a href="/categories/how-to/"><i class="far fa-folder fa-fw"></i>How To</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2014-04-16">2014-04-16</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1144 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/posts/extra-large-icons.png"
        data-srcset="/images/posts/extra-large-icons.png, /images/posts/extra-large-icons.png 1.5x, /images/posts/extra-large-icons.png 2x"
        data-sizes="auto"
        alt="/images/posts/extra-large-icons.png"
        title="/images/posts/extra-large-icons.png" /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#extracting-system-icons-from-win32">Extracting system icons from Win32</a>
      <ul>
        <li><a href="#overwiew">Overwiew</a></li>
        <li><a href="#show-me-the-final-code">Show me the (final) code</a></li>
        <li><a href="#the-ingredients">The ingredients</a></li>
        <li><a href="#putting-it-all-together">Putting it all together</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="extracting-system-icons-from-win32">Extracting system icons from Win32</h2>
<h3 id="overwiew">Overwiew</h3>
<p>Hi, everyone! :)</p>
<p>In a recent project I was required to show a list of files with their associated icons. It doesn&rsquo;t sounds quite difficult, and in fact it is not. Except if you have to deal with files in network paths or you want to get different icons sizes, apart the typical 32×32. And well, that was the case <i class="fas fa-grin-beam-sweat"></i></p>
<p>If you only need local files and sizes of 32x32 píxels you can achieve this using the static method <a href="http://msdn.microsoft.com/en-us/library/vstudio/system.drawing.icon.extractassociatedicon" target="_blank" rel="noopener noreffer">ExtractAssociatedIcon</a> in the class System.Drawing.Icon, but sadly this method doesn’t work with UNC (Universal Naming Convention) paths nor return other sizes that 32×32 pixels.</p>
<p>I had to show four different icons sizes including the extra-large icon also called “jumbo”, so I had to some functions and structures from the Win32 API. Of course, if anyone knows a better way to do it, please contact with me ASAP <i class="fas fa-grin-wink"></i></p>
<h3 id="show-me-the-final-code">Show me the (final) code</h3>
<p>Today I prefer to start from the end so before starting, let’s take a look to the final code:</p>
<p>From a file path and the desired size we wanna retrieve the associated icon.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="hl"><span class="lnt">3
</span></span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">filename</span> <span class="p">=</span> <span class="s">&#34;\\myNetworkResource\Folder\SampleDocument.pdf&#34;</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">size</span> <span class="p">=</span> <span class="n">IconSizeEnum</span><span class="p">.</span><span class="n">ExtraLargeIcon</span><span class="p">;</span>
<span class="hl"><span class="kt">var</span> <span class="n">image</span> <span class="p">=</span> <span class="n">GetFileImageFromPath</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="the-ingredients">The ingredients</h3>
<p>Here are declared all the functions and types we need to use. You can simply paste all this code into a class.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="na">[ComImportAttribute()]</span>
<span class="na">[GuidAttribute(&#34;46EB5926-582E-4017-9FDF-E8998DAA0950&#34;)]</span>
<span class="na">[InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)]</span>
<span class="k">private</span> <span class="k">interface</span> <span class="n">IImageList</span>
<span class="p">{</span>
<span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">Add</span><span class="p">(</span>
        <span class="n">IntPtr</span> <span class="n">hbmImage</span><span class="p">,</span>
        <span class="n">IntPtr</span> <span class="n">hbmMask</span><span class="p">,</span>
        <span class="k">ref</span> <span class="kt">int</span> <span class="n">pi</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">ReplaceIcon</span><span class="p">(</span>
        <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
        <span class="n">IntPtr</span> <span class="n">hicon</span><span class="p">,</span>
        <span class="k">ref</span> <span class="kt">int</span> <span class="n">pi</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">SetOverlayImage</span><span class="p">(</span>
        <span class="kt">int</span> <span class="n">iImage</span><span class="p">,</span>
        <span class="kt">int</span> <span class="n">iOverlay</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">Replace</span><span class="p">(</span>
        <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
        <span class="n">IntPtr</span> <span class="n">hbmImage</span><span class="p">,</span>
        <span class="n">IntPtr</span> <span class="n">hbmMask</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">AddMasked</span><span class="p">(</span>
        <span class="n">IntPtr</span> <span class="n">hbmImage</span><span class="p">,</span>
        <span class="kt">int</span> <span class="n">crMask</span><span class="p">,</span>
        <span class="k">ref</span> <span class="kt">int</span> <span class="n">pi</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">Draw</span><span class="p">(</span>
        <span class="k">ref</span> <span class="n">IMAGELISTDRAWPARAMS</span> <span class="n">pimldp</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">Remove</span><span class="p">(</span>
        <span class="kt">int</span> <span class="n">i</span><span class="p">);</span>
<span class="na">
</span><span class="na">    [PreserveSig]</span>
    <span class="kt">int</span> <span class="n">GetIcon</span><span class="p">(</span>
        <span class="kt">int</span> <span class="n">i</span><span class="p">,</span>
        <span class="kt">int</span> <span class="n">flags</span><span class="p">,</span>
        <span class="k">ref</span> <span class="n">IntPtr</span> <span class="n">picon</span><span class="p">);</span>
<span class="p">};</span>
<span class="k">private</span> <span class="k">struct</span> <span class="nc">IMAGELISTDRAWPARAMS</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">cbSize</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">himl</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">hdcDst</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">x</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">y</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">cx</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">cy</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">xBitmap</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">yBitmap</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">rgbBk</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">rgbFg</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">fStyle</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">dwRop</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">fState</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">Frame</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">crEffect</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">private</span> <span class="k">struct</span> <span class="nc">SHFILEINFO</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">IntPtr</span> <span class="n">hIcon</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">iIcon</span><span class="p">;</span>
    <span class="k">public</span> <span class="kt">uint</span> <span class="n">dwAttributes</span><span class="p">;</span>
<span class="na">    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 254)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">szDisplayName</span><span class="p">;</span>
<span class="na">    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">szTypeName</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">SHGFI_SMALLICON</span> <span class="p">=</span> <span class="m">0</span><span class="n">x1</span><span class="p">;</span>
<span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">SHGFI_LARGEICON</span> <span class="p">=</span> <span class="m">0</span><span class="n">x0</span><span class="p">;</span>
<span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">SHIL_JUMBO</span> <span class="p">=</span> <span class="m">0</span><span class="n">x4</span><span class="p">;</span>
<span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">SHIL_EXTRALARGE</span> <span class="p">=</span> <span class="m">0</span><span class="n">x2</span><span class="p">;</span>
<span class="k">private</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">WM_CLOSE</span> <span class="p">=</span> <span class="m">0</span><span class="n">x0010</span><span class="p">;</span>

<span class="k">public</span> <span class="k">enum</span> <span class="n">IconSizeEnum</span>
<span class="p">{</span>
    <span class="n">SmallIcon16</span> <span class="p">=</span> <span class="n">SHGFI_SMALLICON</span><span class="p">,</span>
    <span class="n">MediumIcon32</span> <span class="p">=</span> <span class="n">SHGFI_LARGEICON</span><span class="p">,</span>
    <span class="n">LargeIcon48</span> <span class="p">=</span> <span class="n">SHIL_EXTRALARGE</span><span class="p">,</span>
    <span class="n">ExtraLargeIcon</span> <span class="p">=</span> <span class="n">SHIL_JUMBO</span>
<span class="p">}</span>
<span class="na">
</span><span class="na">[DllImport(&#34;user32&#34;)]</span>
<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span>
    <span class="n">IntPtr</span> <span class="n">SendMessage</span><span class="p">(</span>
    <span class="n">IntPtr</span> <span class="n">handle</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">Msg</span><span class="p">,</span>
    <span class="n">IntPtr</span> <span class="n">wParam</span><span class="p">,</span>
    <span class="n">IntPtr</span> <span class="n">lParam</span><span class="p">);</span>
<span class="na">
</span><span class="na">[DllImport(&#34;shell32.dll&#34;)]</span>
<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">int</span> <span class="n">SHGetImageList</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">iImageList</span><span class="p">,</span>
    <span class="k">ref</span> <span class="n">Guid</span> <span class="n">riid</span><span class="p">,</span>
    <span class="k">out</span> <span class="n">IImageList</span> <span class="n">ppv</span><span class="p">);</span>
<span class="na">
</span><span class="na">[DllImport(&#34;Shell32.dll&#34;)]</span>
<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">int</span> <span class="n">SHGetFileInfo</span><span class="p">(</span>
    <span class="kt">string</span> <span class="n">pszPath</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">dwFileAttributes</span><span class="p">,</span>
    <span class="k">ref</span> <span class="n">SHFILEINFO</span> <span class="n">psfi</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">cbFileInfo</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">uFlags</span><span class="p">);</span>
<span class="na">
</span><span class="na">[DllImport(&#34;user32&#34;)]</span>
<span class="k">private</span> <span class="k">static</span> <span class="k">extern</span> <span class="kt">int</span> <span class="n">DestroyIcon</span><span class="p">(</span>
    <span class="n">IntPtr</span> <span class="n">hIcon</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="putting-it-all-together">Putting it all together</h3>
<p>In this code we’re using several API calls to the functions we declared before. You can paste all this code in the same class.
Here’s the tricky part:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">static</span> <span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Bitmap</span> <span class="n">GetFileImageFromPath</span><span class="p">(</span>
    <span class="kt">string</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">IconSizeEnum</span> <span class="n">iconsize</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">IntPtr</span> <span class="n">hIcon</span> <span class="p">=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">Directory</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
        <span class="n">hIcon</span> <span class="p">=</span> <span class="n">GetIconHandleFromFolderPath</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">iconsize</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">File</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">))</span>
            <span class="n">hIcon</span> <span class="p">=</span> <span class="n">GetIconHandleFromFilePath</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">iconsize</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">GetBitmapFromIconHandle</span><span class="p">(</span><span class="n">hIcon</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="n">IntPtr</span> <span class="n">GetIconHandleFromFilePath</span><span class="p">(</span><span class="kt">string</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">IconSizeEnum</span> <span class="n">iconsize</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">shinfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SHFILEINFO</span><span class="p">();</span>
    <span class="k">const</span> <span class="kt">uint</span> <span class="n">SHGFI_SYSICONINDEX</span> <span class="p">=</span> <span class="m">0</span><span class="n">x4000</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">FILE_ATTRIBUTE_NORMAL</span> <span class="p">=</span> <span class="m">0</span><span class="n">x80</span><span class="p">;</span>
    <span class="kt">uint</span> <span class="n">flags</span> <span class="p">=</span> <span class="n">SHGFI_SYSICONINDEX</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">GetIconHandleFromFilePathWithFlags</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">iconsize</span><span class="p">,</span> <span class="k">ref</span> <span class="n">shinfo</span><span class="p">,</span> <span class="n">FILE_ATTRIBUTE_NORMAL</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="n">IntPtr</span> <span class="n">GetIconHandleFromFolderPath</span><span class="p">(</span><span class="kt">string</span> <span class="n">folderpath</span><span class="p">,</span> <span class="n">IconSizeEnum</span> <span class="n">iconsize</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">shinfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SHFILEINFO</span><span class="p">();</span>

    <span class="k">const</span> <span class="kt">uint</span> <span class="n">SHGFI_ICON</span> <span class="p">=</span> <span class="m">0</span><span class="n">x000000100</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">uint</span> <span class="n">SHGFI_USEFILEATTRIBUTES</span> <span class="p">=</span> <span class="m">0</span><span class="n">x000000010</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">FILE_ATTRIBUTE_DIRECTORY</span> <span class="p">=</span> <span class="m">0</span><span class="n">x00000010</span><span class="p">;</span>
    <span class="kt">uint</span> <span class="n">flags</span> <span class="p">=</span> <span class="n">SHGFI_ICON</span> <span class="p">|</span> <span class="n">SHGFI_USEFILEATTRIBUTES</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">GetIconHandleFromFilePathWithFlags</span><span class="p">(</span><span class="n">folderpath</span><span class="p">,</span> <span class="n">iconsize</span><span class="p">,</span> <span class="k">ref</span> <span class="n">shinfo</span><span class="p">,</span> <span class="n">FILE_ATTRIBUTE_DIRECTORY</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Bitmap</span> <span class="n">GetBitmapFromIconHandle</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">hIcon</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">hIcon</span> <span class="p">==</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">)</span> <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">myIcon</span> <span class="p">=</span> <span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Icon</span><span class="p">.</span><span class="n">FromHandle</span><span class="p">(</span><span class="n">hIcon</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">bitmap</span> <span class="p">=</span> <span class="n">myIcon</span><span class="p">.</span><span class="n">ToBitmap</span><span class="p">();</span>
    <span class="n">myIcon</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
    <span class="n">DestroyIcon</span><span class="p">(</span><span class="n">hIcon</span><span class="p">);</span>
    <span class="n">SendMessage</span><span class="p">(</span><span class="n">hIcon</span><span class="p">,</span> <span class="n">WM_CLOSE</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">,</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">bitmap</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span> <span class="k">static</span> <span class="n">IntPtr</span> <span class="n">GetIconHandleFromFilePathWithFlags</span><span class="p">(</span>
    <span class="kt">string</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">IconSizeEnum</span> <span class="n">iconsize</span><span class="p">,</span>
    <span class="k">ref</span> <span class="n">SHFILEINFO</span> <span class="n">shinfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fileAttributeFlag</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">ILD_TRANSPARENT</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">retval</span> <span class="p">=</span> <span class="n">SHGetFileInfo</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">fileAttributeFlag</span><span class="p">,</span> <span class="k">ref</span> <span class="n">shinfo</span><span class="p">,</span> <span class="n">Marshal</span><span class="p">.</span><span class="n">SizeOf</span><span class="p">(</span><span class="n">shinfo</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">retval</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">throw</span> <span class="p">(</span><span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">FileNotFoundException</span><span class="p">());</span>
    <span class="kt">var</span> <span class="n">iconIndex</span> <span class="p">=</span> <span class="n">shinfo</span><span class="p">.</span><span class="n">iIcon</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">iImageListGuid</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Guid</span><span class="p">(</span><span class="s">&#34;46EB5926-582E-4017-9FDF-E8998DAA0950&#34;</span><span class="p">);</span>
    <span class="n">IImageList</span> <span class="n">iml</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">hres</span> <span class="p">=</span> <span class="n">SHGetImageList</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">iconsize</span><span class="p">,</span> <span class="k">ref</span> <span class="n">iImageListGuid</span><span class="p">,</span> <span class="k">out</span> <span class="n">iml</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">hIcon</span> <span class="p">=</span> <span class="n">IntPtr</span><span class="p">.</span><span class="n">Zero</span><span class="p">;</span>
    <span class="n">hres</span> <span class="p">=</span> <span class="n">iml</span><span class="p">.</span><span class="n">GetIcon</span><span class="p">(</span><span class="n">iconIndex</span><span class="p">,</span> <span class="n">ILD_TRANSPARENT</span><span class="p">,</span> <span class="k">ref</span> <span class="n">hIcon</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">hIcon</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<p>First, we need to call to <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb762179%28v=vs.85%29.aspx" target="_blank" rel="noopener noreffer">SHGetFileInfo</a> function that receives a reference to a structure of type <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb759792%28v=vs.85%29.aspx" target="_blank" rel="noopener noreffer">SHFILEINFO</a>, which contains the index of the icon image within the system image list. We will use this index later.</p>
<p>Then we’ve to perform a second call to the <a href="http://www.pinvoke.net/default.aspx/shell32.shgetimagelist" target="_blank" rel="noopener noreffer">SHGetImageList</a> function that receives an output parameter with an <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb761490%28v=vs.85%29.aspx" target="_blank" rel="noopener noreffer">IImageList</a> structure, which is modified within the function.</p>
<p>Once we have that COM interface, we only need to call its <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/bb761463%28v=vs.85%29.aspx" target="_blank" rel="noopener noreffer">GetIcon</a> method, passing a parameter with the desired size, and obtaining a handle to the icon by reference.</p>
<p>Finally, using the handle we can create an Icon and then convert it to a Bitmap or BitmapSource:</p>
<blockquote>
<p>Tip: Don’t forget to destroy the resources (Icon) when working with the Win32 API!</p>
</blockquote>
<p>For better use I’ve also created an enumeration IconSizeEnum (see types declaration) with the different flags values as well:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">enum</span> <span class="n">IconSizeEnum</span>
<span class="p">{</span>
    <span class="n">SmallIcon16</span> <span class="p">=</span> <span class="n">SHGFI_SMALLICON</span><span class="p">,</span>
    <span class="n">MediumIcon32</span> <span class="p">=</span> <span class="n">SHGFI_LARGEICON</span><span class="p">,</span>
    <span class="n">LargeIcon48</span> <span class="p">=</span> <span class="n">SHIL_EXTRALARGE</span><span class="p">,</span>
    <span class="n">ExtraLargeIcon</span> <span class="p">=</span> <span class="n">SHIL_JUMBO</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<p>Finally, create a new Form and add a PictureBox named &lsquo;pictureBox1&rsquo; a label called &lsquo;labelFilePath&rsquo; and a Button, and into the Button&rsquo;s click event handler use this code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-csharp" data-lang="csharp"><span class="kt">var</span> <span class="n">size</span> <span class="p">=</span> <span class="n">IconSizeEnum</span><span class="p">.</span><span class="n">ExtraLargeIcon</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">ofd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">OpenFileDialog</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="n">ofd</span><span class="p">.</span><span class="n">ShowDialog</span><span class="p">()</span> <span class="p">==</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">DialogResult</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">labelFilePath</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="n">ofd</span><span class="p">.</span><span class="n">FileName</span><span class="p">;</span>
    <span class="n">pictureBox1</span><span class="p">.</span><span class="n">Image</span> <span class="p">=</span> <span class="n">YourClassNameHere</span><span class="p">.</span><span class="n">GetFileImageFromPath</span><span class="p">(</span><span class="n">ofd</span><span class="p">.</span><span class="n">FileName</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>You can also use UNC paths, including network paths :)</p>
</blockquote>
<p>Hope this helps! ;)</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2014-04-16</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/extract-icons-win32/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://lluisfranco.com/extract-icons-win32/" data-title="Extract extra large icon from a file, folder or drive" data-via="lluisfranco" data-hashtags="csharp,net framework,API,Win32"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://lluisfranco.com/extract-icons-win32/" data-hashtag="csharp"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://lluisfranco.com/extract-icons-win32/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://lluisfranco.com/extract-icons-win32/" data-title="Extract extra large icon from a file, folder or drive" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Pinterest" data-sharer="pinterest" data-url="https://lluisfranco.com/extract-icons-win32/" data-image="/images/posts/extra-large-icons.png"><i class="fab fa-pinterest fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://lluisfranco.com/extract-icons-win32/"><i class="fab fa-reddit fa-fw"></i></a><a href="javascript:void(0);" title="Share on Instapaper" data-sharer="instapaper" data-url="https://lluisfranco.com/extract-icons-win32/" data-title="Extract extra large icon from a file, folder or drive" data-description=""><i data-svg-src="/lib/simple-icons/icons/instapaper.min.svg"></i></a><a href="javascript:void(0);" title="Share on Pocket" data-sharer="pocket" data-url="https://lluisfranco.com/extract-icons-win32/"><i class="fab fa-get-pocket fa-fw"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://lluisfranco.com/extract-icons-win32/" data-title="Extract extra large icon from a file, folder or drive"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/csharp/">csharp</a>,&nbsp;<a href="/tags/net-framework/">net framework</a>,&nbsp;<a href="/tags/api/">API</a>,&nbsp;<a href="/tags/win32/">Win32</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/mvp-site-interview/" class="prev" rel="prev" title="MVP site interview"><i class="fas fa-angle-left fa-fw"></i>MVP site interview</a>
            <a href="/remove-diacritics-in-strings/" class="next" rel="next" title="Remove diacritics (accents) in strings">Remove diacritics (accents) in strings<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/about/" target="_blank">lluís</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":20},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
