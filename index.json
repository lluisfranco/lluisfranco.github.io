[{"categories":["Development","How To"],"content":"Quick note How to remove diacritics (accents) from a C# string? public static string RemoveDiacritics(this string input) { var stFormD = input.Normalize(NormalizationForm.FormD); var len = stFormD.Length; var sb = new StringBuilder(); for (int i = 0; i \u003c len; i++) { var uc = System.Globalization.CharUnicodeInfo.GetUnicodeCategory(stFormD[i]); if (uc != System.Globalization.UnicodeCategory.NonSpacingMark) { sb.Append(stFormD[i]); } } return (sb.ToString().Normalize(NormalizationForm.FormC)); } ","date":"2014-06-26","objectID":"/remove-diacritics-in-strings/:1:0","tags":["csharp","net framework","Tip","SQL"],"title":"Remove diacritics (accents) in strings","uri":"/remove-diacritics-in-strings/"},{"categories":["Development","How To"],"content":"Bonus track How to remove in TSQL (Microsoft SQL Server) SELECT'√†√©√™√∂hello!'CollateSQL_Latin1_General_CP1253_CI_AI See you soon! üòâ ","date":"2014-06-26","objectID":"/remove-diacritics-in-strings/:2:0","tags":["csharp","net framework","Tip","SQL"],"title":"Remove diacritics (accents) in strings","uri":"/remove-diacritics-in-strings/"},{"categories":["Development","How To"],"content":"Extracting system icons from Win32 ","date":"2014-04-16","objectID":"/extract-icons-win32/:1:0","tags":["csharp","net framework","API","Win32"],"title":"Extract extra large icon from a file, folder or drive","uri":"/extract-icons-win32/"},{"categories":["Development","How To"],"content":"Overwiew Hi, everyone! :) In a recent project I was required to show a list of files with their associated icons. It doesn‚Äôt sounds quite difficult, and in fact it is not. Except if you have to deal with files in network paths or you want to get different icons sizes, apart the typical 32√ó32. And well, that was the case If you only need local files and sizes of 32x32 p√≠xels you can achieve this using the static method ExtractAssociatedIcon in the class System.Drawing.Icon, but sadly this method doesn‚Äôt work with UNC (Universal Naming Convention) paths nor return other sizes that 32√ó32 pixels. I had to show four different icons sizes including the extra-large icon also called ‚Äújumbo‚Äù, so I had to some functions and structures from the Win32 API. Of course, if anyone knows a better way to do it, please contact with me ASAP ","date":"2014-04-16","objectID":"/extract-icons-win32/:1:1","tags":["csharp","net framework","API","Win32"],"title":"Extract extra large icon from a file, folder or drive","uri":"/extract-icons-win32/"},{"categories":["Development","How To"],"content":"Show me the (final) code Today I prefer to start from the end so before starting, let‚Äôs take a look to the final code: From a file path and the desired size we wanna retrieve the associated icon. var filename = \"\\\\myNetworkResource\\Folder\\SampleDocument.pdf\"; var size = IconSizeEnum.ExtraLargeIcon; var image = GetFileImageFromPath(filename, size); ","date":"2014-04-16","objectID":"/extract-icons-win32/:1:2","tags":["csharp","net framework","API","Win32"],"title":"Extract extra large icon from a file, folder or drive","uri":"/extract-icons-win32/"},{"categories":["Development","How To"],"content":"The ingredients Here are declared all the functions and types we need to use. You can simply paste all this code into a class. [ComImportAttribute()] [GuidAttribute(\"46EB5926-582E-4017-9FDF-E8998DAA0950\")] [InterfaceTypeAttribute(ComInterfaceType.InterfaceIsIUnknown)] private interface IImageList { [PreserveSig] int Add( IntPtr hbmImage, IntPtr hbmMask, ref int pi); [PreserveSig] int ReplaceIcon( int i, IntPtr hicon, ref int pi); [PreserveSig] int SetOverlayImage( int iImage, int iOverlay); [PreserveSig] int Replace( int i, IntPtr hbmImage, IntPtr hbmMask); [PreserveSig] int AddMasked( IntPtr hbmImage, int crMask, ref int pi); [PreserveSig] int Draw( ref IMAGELISTDRAWPARAMS pimldp); [PreserveSig] int Remove( int i); [PreserveSig] int GetIcon( int i, int flags, ref IntPtr picon); }; private struct IMAGELISTDRAWPARAMS { public int cbSize; public IntPtr himl; public int i; public IntPtr hdcDst; public int x; public int y; public int cx; public int cy; public int xBitmap; public int yBitmap; public int rgbBk; public int rgbFg; public int fStyle; public int dwRop; public int fState; public int Frame; public int crEffect; } private struct SHFILEINFO { public IntPtr hIcon; public int iIcon; public uint dwAttributes; [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 254)] public string szDisplayName; [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)] public string szTypeName; } private const int SHGFI_SMALLICON = 0x1; private const int SHGFI_LARGEICON = 0x0; private const int SHIL_JUMBO = 0x4; private const int SHIL_EXTRALARGE = 0x2; private const int WM_CLOSE = 0x0010; public enum IconSizeEnum { SmallIcon16 = SHGFI_SMALLICON, MediumIcon32 = SHGFI_LARGEICON, LargeIcon48 = SHIL_EXTRALARGE, ExtraLargeIcon = SHIL_JUMBO } [DllImport(\"user32\")] private static extern IntPtr SendMessage( IntPtr handle, int Msg, IntPtr wParam, IntPtr lParam); [DllImport(\"shell32.dll\")] private static extern int SHGetImageList( int iImageList, ref Guid riid, out IImageList ppv); [DllImport(\"Shell32.dll\")] private static extern int SHGetFileInfo( string pszPath, int dwFileAttributes, ref SHFILEINFO psfi, int cbFileInfo, uint uFlags); [DllImport(\"user32\")] private static extern int DestroyIcon( IntPtr hIcon); ","date":"2014-04-16","objectID":"/extract-icons-win32/:1:3","tags":["csharp","net framework","API","Win32"],"title":"Extract extra large icon from a file, folder or drive","uri":"/extract-icons-win32/"},{"categories":["Development","How To"],"content":"Putting it all together In this code we‚Äôre using several API calls to the functions we declared before. You can paste all this code in the same class. Here‚Äôs the tricky part: public static System.Drawing.Bitmap GetFileImageFromPath( string filepath, IconSizeEnum iconsize) { IntPtr hIcon = IntPtr.Zero; if (System.IO.Directory.Exists(filepath)) hIcon = GetIconHandleFromFolderPath(filepath, iconsize); else if (System.IO.File.Exists(filepath)) hIcon = GetIconHandleFromFilePath(filepath, iconsize); return GetBitmapFromIconHandle(hIcon); } private static IntPtr GetIconHandleFromFilePath(string filepath, IconSizeEnum iconsize) { var shinfo = new SHFILEINFO(); const uint SHGFI_SYSICONINDEX = 0x4000; const int FILE_ATTRIBUTE_NORMAL = 0x80; uint flags = SHGFI_SYSICONINDEX; return GetIconHandleFromFilePathWithFlags(filepath, iconsize, ref shinfo, FILE_ATTRIBUTE_NORMAL, flags); } private static IntPtr GetIconHandleFromFolderPath(string folderpath, IconSizeEnum iconsize) { var shinfo = new SHFILEINFO(); const uint SHGFI_ICON = 0x000000100; const uint SHGFI_USEFILEATTRIBUTES = 0x000000010; const int FILE_ATTRIBUTE_DIRECTORY = 0x00000010; uint flags = SHGFI_ICON | SHGFI_USEFILEATTRIBUTES; return GetIconHandleFromFilePathWithFlags(folderpath, iconsize, ref shinfo, FILE_ATTRIBUTE_DIRECTORY, flags); } private static System.Drawing.Bitmap GetBitmapFromIconHandle(IntPtr hIcon) { if (hIcon == IntPtr.Zero) return null; var myIcon = System.Drawing.Icon.FromHandle(hIcon); var bitmap = myIcon.ToBitmap(); myIcon.Dispose(); DestroyIcon(hIcon); SendMessage(hIcon, WM_CLOSE, IntPtr.Zero, IntPtr.Zero); return bitmap; } private static IntPtr GetIconHandleFromFilePathWithFlags( string filepath, IconSizeEnum iconsize, ref SHFILEINFO shinfo, int fileAttributeFlag, uint flags) { const int ILD_TRANSPARENT = 1; var retval = SHGetFileInfo(filepath, fileAttributeFlag, ref shinfo, Marshal.SizeOf(shinfo), flags); if (retval == 0) throw (new System.IO.FileNotFoundException()); var iconIndex = shinfo.iIcon; var iImageListGuid = new Guid(\"46EB5926-582E-4017-9FDF-E8998DAA0950\"); IImageList iml; var hres = SHGetImageList((int)iconsize, ref iImageListGuid, out iml); var hIcon = IntPtr.Zero; hres = iml.GetIcon(iconIndex, ILD_TRANSPARENT, ref hIcon); return hIcon; } First, we need to call to SHGetFileInfo function that receives a reference to a structure of type SHFILEINFO, which contains the index of the icon image within the system image list. We will use this index later. Then we‚Äôve to perform a second call to the SHGetImageList function that receives an output parameter with an IImageList structure, which is modified within the function. Once we have that COM interface, we only need to call its GetIcon method, passing a parameter with the desired size, and obtaining a handle to the icon by reference. Finally, using the handle we can create an Icon and then convert it to a Bitmap or BitmapSource: Tip: Don‚Äôt forget to destroy the resources (Icon) when working with the Win32 API! For better use I‚Äôve also created an enumeration IconSizeEnum (see types declaration) with the different flags values as well: public enum IconSizeEnum { SmallIcon16 = SHGFI_SMALLICON, MediumIcon32 = SHGFI_LARGEICON, LargeIcon48 = SHIL_EXTRALARGE, ExtraLargeIcon = SHIL_JUMBO } Finally, create a new Form and add a PictureBox named ‚ÄòpictureBox1‚Äô a label called ‚ÄòlabelFilePath‚Äô and a Button, and into the Button‚Äôs click event handler use this code: var size = IconSizeEnum.ExtraLargeIcon; var ofd = new OpenFileDialog(); if (ofd.ShowDialog() == System.Windows.Forms.DialogResult.OK) { labelFilePath.Text = ofd.FileName; pictureBox1.Image = YourClassNameHere.GetFileImageFromPath(ofd.FileName, size); } You can also use UNC paths, including network paths :) Hope this helps! ;) ","date":"2014-04-16","objectID":"/extract-icons-win32/:1:4","tags":["csharp","net framework","API","Win32"],"title":"Extract extra large icon from a file, folder or drive","uri":"/extract-icons-win32/"},{"categories":["Awards"],"content":"My 5 minutes of glory üòÇ Yesterday was published my brief interview in the MVP site. However, it is not the full version, that I copy here. ","date":"2012-10-31","objectID":"/mvp-site-interview/:1:0","tags":["Microsoft","MVP","Interview"],"title":"MVP site interview","uri":"/mvp-site-interview/"},{"categories":["Awards"],"content":"About Llu√≠s Franco Born in Barcelona (Spain) with more than 20 years of experience in the software development sector, now lives in Andorra for the past 15 years with his family. Lluis holds a number of Microsoft official certifications such as MCP and MCTS and has been recognized as MVP for the past 10 years due to his active participation and moderation in the MSDN forums since 1997. Currently works as project development manager at FIMARGE a finantial services company based in Andorra. He founded the AndorraDotNet user group in 2007, being the first and almost unique user group based in the country. Since 2010 he is also the president of the Andorra IT Professionals Virtual Association. He owns several blogs and is also a regular host and speaker in local events in the region, such as the ‚ÄúGeek-A-Paloozaa‚Äù conference that took place each summer. He also contributes articles to the technological section of a local newspaper. ","date":"2012-10-31","objectID":"/mvp-site-interview/:1:1","tags":["Microsoft","MVP","Interview"],"title":"MVP site interview","uri":"/mvp-site-interview/"},{"categories":["Awards"],"content":"Llu√≠s Franco Interview 1 What does it mean being an MVP? It is something much more important to me now than when I was first awarded, as I wasn‚Äôt aware at that time of all the wonderful things that would happen to me and the great people I would meet over the time. Not only at a technical level, what the MVP community of course has, but also for the human quality of the majority of MVPs. I met many of my current best friends thanks to the MVP Program. 2 How was your start in the community? It happened just by chance. As it was the case of many professionals in the IT industry I needed help to solve a problem and posted a question in the today disappeared Microsoft newsgroups, where I got the answer to my questions. I just loved this way of learning from other community members and one day I decided to give something back to them and I started to reply questions there. Sometime after I started running a webpage, a blog, another blog‚Ä¶. At some point I did a presentation at a local user group meeting and finally I started a new user group, hosting events‚Ä¶ And I still really enjoy doing these things today. 3 What would you ask Steve Ballmer? Let me see‚Ä¶ The first thing that comes to my mind is to ask about some Microsoft business segments long-term strategy. But this is something that almost everybody would ask him, so I would rather ask about the good old times‚Ä¶ So Steve, in your opinion, what has been the most important fact in Microsoft‚Äôs history? I am talking about the key factor or point in time that has made Microsoft what it is today. 4 What is the best software product in history? I am in love with C#. For me this is the most beautiful, complete, and powerful programming language ever created. So therefore, the best software product for me is Visual Studio 2012, the best IDE in history (or at least the best I have ever used, that are many). Talking about operating systems, I have no doubt; Windows 8 is far the best one. At that point I have to say that I have not always worked with Microsoft products. 5 What would you change on Visual C#? I would continuously add functional characteristics to it. In the latest versions we have seen the introduction of generic functions, delegates management, LINQ and moreover, lambda expressions have made of C# the programming language I have always dreamed about. It is really fun programming on C#! However some things are still missing such as Nested functions, for example. So as some of my friends mentioned to me, this would make functions to be considered 1st level citizens. There are also other things such as making the Framework and IDE a bit lighter. There are many different types of objects there and some collections could be eliminated. 6 Which is the last book you have read? I am a compulsive technical book reader. But I also love fiction and science fiction books. I have last read ‚ÄòReady Player One‚Äô, a novel with plenty of references of the 80‚Äôs : videogames, music, films, role games, comics and even toys. It has a young writing style and I could identify myself with the background described there. I also read technical books and of course, my favorite one: ‚ÄòThe Silmarillion‚Äô. 7 Which music CD would you recommend? Just one? In that case I would go for Radiohead‚Äôs ‚ÄòOk Computer‚Äô. I really love this band‚Äôs the first albums. I like different kind of music from Bach to the heavy metal, including Jazz music too. 8 What makes you an excellent MVP? I don‚Äôt consider myself an ‚Äúexcellent MVP‚Äù. For me being an MVP means a person with some technical skills but that is willing to share his knowledge and passion with the community in different ways, helping others that have helped them before. So the most important thing here is having the right attitude. So somebody that considers himself as being better than others because of the MVP Award probably wouldn‚Äôt deserve this recognition. 9 What is in your ‚ÄúComputer Bag‚Äù? There is less and less software and more and more hardware in there. Many sm","date":"2012-10-31","objectID":"/mvp-site-interview/:1:2","tags":["Microsoft","MVP","Interview"],"title":"MVP site interview","uri":"/mvp-site-interview/"},{"categories":["Awards"],"content":"MVP of the year 2011 Surprised. Puzzled. Amazed. These are the words that define better my current feelings. However, while writing these lines I‚Äôm just realizing I have a blissful smile, or maybe just a stupid smile. Why? Because I just received an email from Lisa Feigenbaum (Microsoft Community Program Manager) with this message: ‚ÄúCongratulations on being awarded C# MVP of the Year based on your contributions in 2011!‚Äù WOW! That‚Äôs amazing, and sincerely, totally unexpected For the last 9 years Ive been awarded as a Microsoft MVP and believe me, that‚Äôs something very important for me. Maybe not for being recognized as an ‚Äúexpert‚Äù because it is hard to use that word while there are so damn good people out there, but because they recognize the work of helping the community. So now, in a private survey all the C# MVPs around the world and the product team have decided to recognize my contributions with the ‚ÄúC# MVP of the year‚Äù award, whatever that means. On the next March 2nd there will be an honorary dinner sponsored by S. Somasegar (‚ÄúSoma‚Äù), Senior Vice President of the Developer Division at Microsoft, with other executives and community leads in the division. Unfortunately, I won‚Äôt be able to attend because I come back from Seattle the same day in the morning. Nevertheless I promise you while I am in Seattle I‚Äôll try to have a beer with some of these guys. From here I‚Äôd like to congratulate the rest of the winners (there are 29 in all categories) and thank all my colleagues. Hey people, you‚Äôre great! Kind regards from Andorra, ","date":"2012-02-16","objectID":"/amazing.-mvp-of-the-year-2011/:1:0","tags":["Microsoft","MVP"],"title":"Amazing: Awarded MVP of the Year!","uri":"/amazing.-mvp-of-the-year-2011/"},{"categories":["Software"],"content":"The issue After a long time‚Ä¶ here we go again! Today a quick post, just a note: If you bought a MacBook Pro and using Boot Camp for running Windows, you may be possible experiment some chipset problems. In my particular case with USB and bluetooth devices (Wireless Notebook Presenter 8000), and a couple of window-freezed. Also, in some ocasions Windows threw an error: ‚ÄúIntel 5 Series/3400 Series Chipset Family USB Universal Host Controller ‚Äì 3B3B (and 3B36) has a driver problem‚Äù. Chipset issues on Windows ","date":"2011-04-07","objectID":"/macbook-pro-series-3400-series-chipset-problems/:1:0","tags":["Apple","Boot Camp","MacBook Pro","Drivers","Chipset","Windows"],"title":"Macbook Pro - Series 3400 series chipset problems?","uri":"/macbook-pro-series-3400-series-chipset-problems/"},{"categories":["Software"],"content":"How to fix it After googling 10 minutes I just realized that lots of people are experimenting the same trouble, and I would like to show how to solve it in 3 simple steps: Open Windows Device Manager Show all devices (including hide devices, View menu) Disable both devices (3B3B \u0026 3B36) That‚Äôs all! :-D Hope you enjoy this. ","date":"2011-04-07","objectID":"/macbook-pro-series-3400-series-chipset-problems/:2:0","tags":["Apple","Boot Camp","MacBook Pro","Drivers","Chipset","Windows"],"title":"Macbook Pro - Series 3400 series chipset problems?","uri":"/macbook-pro-series-3400-series-chipset-problems/"},{"categories":["Development","How To"],"content":"The scenario In business applications it‚Äôs very common checking if the current user is member of the ‚Äòdomain administrators‚Äô role of your company. For example, recently I had to check if the current user has administrative privileges in order to show some advanced configuration options. ","date":"2010-12-13","objectID":"/check-current-user-is-domain-admin/:1:0","tags":["csharp","net framework","API","Win32","Active Directory","Domain","Administrator"],"title":"Check if current user is domain administrator","uri":"/check-current-user-is-domain-admin/"},{"categories":["Development","How To"],"content":"IsInRole To acomplish this we could use the IsInRole method from the WindowsPrincipal class. This method checks if an user is member of a Windows role and returns a bool value. One of its overrides allows to pass the SID of the role or a constant value based on the enumeration WindowsBuiltInrole. Note: For performance reasons, it‚Äôs recommended to use the override: IsinRole(SecurityIdentifier). To check if current user is an administrator on the local computer we only need to do this: var wp = new WindowsPrincipal(WindowsIdentity.GetCurrent()); return wp.IsInRole(WindowsBuiltInRole.Administrator); Notice that it‚Äôs realy easy, but WindowsBuiltInrole enumeration only contains local roles. So, if we would check if our user is member of a domain group, we should find the role SID in our domain. ","date":"2010-12-13","objectID":"/check-current-user-is-domain-admin/:1:1","tags":["csharp","net framework","API","Win32","Active Directory","Domain","Administrator"],"title":"Check if current user is domain administrator","uri":"/check-current-user-is-domain-admin/"},{"categories":["Development","How To"],"content":"WellKnownSidType Let‚Äôs take a look at the following enumeration WellKnownSidType, this enumeration provides commonly used security identifiers and that‚Äôs exactly whan we want. Let‚Äôs try to use it in our code: var wp = new WindowsPrincipal(WindowsIdentity.GetCurrent()); var sid = new SecurityIdentifier(WellKnownSidType.AccountDomainAdminsSid, null); return wp.IsInRole(sid); Boom! Do‚Äôh! It seems that we need to pass the second argument called DomainSId, which represents the security identifier of your company domain. ","date":"2010-12-13","objectID":"/check-current-user-is-domain-admin/:1:2","tags":["csharp","net framework","API","Win32","Active Directory","Domain","Administrator"],"title":"Check if current user is domain administrator","uri":"/check-current-user-is-domain-admin/"},{"categories":["Development","How To"],"content":"DomainSid This domain SID is required for some WellKnownSidType values and we can get it using the DirectoryEntry class from the assembly System.DirectoryServices. var domain = Domain.GetDomain(new DirectoryContext( DirectoryContextType.Domain, IPGlobalProperties.GetIPGlobalProperties().DomainName)); using (DirectoryEntry de = domain.GetDirectoryEntry()) { var domainSIdArray = (byte[])de.Properties[\"objectSid\"].Value; var domainSId = new SecurityIdentifier(domainSIdArray, 0); } First, we obtain a reference to the domain using the domain name. Then get of the value the property objectSid as a byte array, and finally transform this value into a valid SecurityIdentifier which is what we need. ","date":"2010-12-13","objectID":"/check-current-user-is-domain-admin/:1:3","tags":["csharp","net framework","API","Win32","Active Directory","Domain","Administrator"],"title":"Check if current user is domain administrator","uri":"/check-current-user-is-domain-admin/"},{"categories":["Development","How To"],"content":"Show me the code Putting it all together. Like my collegue and friend @alegrebandolero I‚Äôm also a fan of extension methods. So, let‚Äôs create an extension method for the WindowsIdentity class: public static bool IsDomainAdmin(this WindowsIdentity identity) { var domain = Domain.GetDomain(new DirectoryContext( DirectoryContextType.Domain, IPGlobalProperties.GetIPGlobalProperties().DomainName)); using (DirectoryEntry de = domain.GetDirectoryEntry()) { var domainSIdArray = (byte[])de.Properties[\"objectSid\"].Value; var domainSId = new SecurityIdentifier(domainSIdArray, 0); var domainAdminsSId = new SecurityIdentifier( WellKnownSidType.AccountDomainAdminsSid, domainSId); var wp = new WindowsPrincipal(identity); return wp.IsInRole(domainAdminsSId); } } That‚Äôs all. Now, use it as follows: if(WindowsIdentity.GetCurrent().IsDomainAdmin()) { //some code here... } Edit 12/14/2010: Since Windows Vista each Windows user have a couple of security tokens. The first one is the normal token with limited privileges, and the second one only works when you ‚Äòrun as administrator‚Äô. This code only works if you are using the second token, running the application as administrator. HYEI, happy coding! December 2010 ","date":"2010-12-13","objectID":"/check-current-user-is-domain-admin/:2:0","tags":["csharp","net framework","API","Win32","Active Directory","Domain","Administrator"],"title":"Check if current user is domain administrator","uri":"/check-current-user-is-domain-admin/"},{"categories":["Development","How To"],"content":"Gettings all controls from a container v2 ","date":"2010-11-15","objectID":"/retrieve-all-controls-using-generics-ii/:1:0","tags":["csharp","net framework","generics","LINQ"],"title":"Retrieve all controls using generics (II)","uri":"/retrieve-all-controls-using-generics-ii/"},{"categories":["Development","How To"],"content":"A better approach In my previous post I created a recursive function to retrieve all controls inside a form and its containers. Today, my colleague and friend Eduard Tom√†s sent me another solution to the same topic based on LINQ. It‚Äôs simply and really, really pretty ‚ù§Ô∏è ","date":"2010-11-15","objectID":"/retrieve-all-controls-using-generics-ii/:1:1","tags":["csharp","net framework","generics","LINQ"],"title":"Retrieve all controls using generics (II)","uri":"/retrieve-all-controls-using-generics-ii/"},{"categories":["Development","How To"],"content":"The power of LINQ Before starting, we need to solve this: LINQ works over IEnumerable, but Control.Controls property returns a ControlCollection type. In fact, nowadays, since we have Generics this class has no sense (like other 1.000 similar classes) but remember that Generics doesn‚Äôt appeared until .NET Framework 2.0. So, our first step will be retrieve an IEnumerable from a ControlCollection property of a Control. This could be accomplished using an extensor method over the class ControlCollection: public static IEnumerable\u003cControl\u003e AsEnumerable(this Control.ControlCollection @this) { foreach (var control in @this) yield return (Control)control; } Note that using this method we are able to transform CollectionControl to IEnumerable and get full access to the power of Linq. Now, let‚Äôs create a method to retrieve all controls of a type: public static IEnumerable\u003cT\u003e GetAllControls\u003cT\u003e(this Control @this) where T : Control { return @this.Controls.AsEnumerable().Where( x =\u003e x.GetType() == typeof(T)).Select( y =\u003e (T)y).Union( @this.Controls.AsEnumerable().SelectMany( x =\u003e GetAllControls\u003cT\u003e(x)).Select(y =\u003e (T)y)); } It looks cool, isn‚Äôt it? No loops, no ifs‚Ä¶ only pure LINQ power! :-) Note that converting Controls property into an Enumerable allow us to use all those IEnumerable LINQ methods like Select, Where, Union or SelectMany‚Ä¶ in just a single line of code! This is amazing, this is functional programming style! ","date":"2010-11-15","objectID":"/retrieve-all-controls-using-generics-ii/:1:2","tags":["csharp","net framework","generics","LINQ"],"title":"Retrieve all controls using generics (II)","uri":"/retrieve-all-controls-using-generics-ii/"},{"categories":["Development","How To"],"content":"Applying several actions There‚Äôs also a small difference with my original solution. In the previous one I used an internal List to copy all controls references. The new one only iterates over the original collection. There‚Äôs no internal lists. Another difference present¬†in LINQ solution is we are returning an IEnumerable, so we loose the ForEach method (because IEnumerable doesn‚Äôt implements this method). But building our own ForEach method is as trivial as: public static void ForEach\u003cT\u003e(this IEnumerable\u003cT\u003e @this, Action\u003cT\u003e action) { foreach (T t in @this) { action(t); } } Now, we‚Äôve all the necessary ingredients to get all controls and do whatever we need :D this.GetAllControls\u003cTextBox\u003e().ForEach(p =\u003e p.Enabled = false); this.GetAllControls\u003cTextBox\u003e().ForEach(p =\u003e { p.BackColor = Color.LightGray; p.ForeColor = Color.Red; p.Text = \"hello\"; p.TextAlign = HorizontalAlignment.Center; }); HYEI, happy coding! :-) November 2010 ","date":"2010-11-15","objectID":"/retrieve-all-controls-using-generics-ii/:1:3","tags":["csharp","net framework","generics","LINQ"],"title":"Retrieve all controls using generics (II)","uri":"/retrieve-all-controls-using-generics-ii/"},{"categories":["Development","How To"],"content":"Gettings all controls from a container ","date":"2010-11-09","objectID":"/retrieve-all-controls-using-generics-i/:1:0","tags":["csharp","net framework","generics"],"title":"Retrieve all controls using generics (I)","uri":"/retrieve-all-controls-using-generics-i/"},{"categories":["Development","How To"],"content":"That‚Äôs the question How many times have you ever heard something similar? :) How to clear the content of all the textboxes in a form? The question may vary a littles bit but it‚Äôs always related to obtain all controls of a determined type (Button TextBox, etc) in a form or maybe in another type of container like a Panel or user control. ","date":"2010-11-09","objectID":"/retrieve-all-controls-using-generics-i/:1:1","tags":["csharp","net framework","generics"],"title":"Retrieve all controls using generics (I)","uri":"/retrieve-all-controls-using-generics-i/"},{"categories":["Development","How To"],"content":"Generics and Extension methods Using generics it‚Äôs really easy! Firstly let‚Äôs create an extensor method, that returns a collection of all the controls of a type in a Form or container. And then, we will use this collection to do an action over each returned item. The extensor method public static List\u003cT\u003e GetControls\u003cT\u003e(this Control container) where T : Control { List\u003cT\u003e controls = new List\u003cT\u003e(); foreach (Control c in container.Controls) { if (c is T) controls.Add((T)c); controls.AddRange(GetControls\u003cT\u003e(c)); } return controls; } This method retrieves the collection of Controls from a container calling it itself recursively, retrieving the content of all his containers. How to use it? this.GetControls\u003cTextBox\u003e().ForEach(p =\u003e p.Text = string.Empty); We can use the extensor method directly into a form because Form class inherits from ContainerControl, that inherits from ScrollableControl, and ScrollableControl from Control. Or, in other words, our Form will implement our extensor method. So, at compile time we should specify the type of the controls we want to retrieve. In the example we are using TextBox, but you can use Button type instead. And then, use ForEach to apply an action on each one of the items returned. Moreover, if we want to retrieve only the controls into a container (GroupBox, Panel, TabControl or another that inherits from Control), you can call the method for this particular control. myPanel.GetControls\u003cButton\u003e().ForEach(p =\u003e p.Enabled = false); Applying several actions In most cases, we would apply several actions to each control (not only one). In this case it‚Äôs quite easy: The only thing we have to do is create a method that receives a parameter of this type, and call it passing the control as an argument: this.GetControls\u003cTextBox\u003e().ForEach(p =\u003e ApplyFormat(p)); private void ApplyFormat(TextBox text) { text.BackColor = Color.LightGray; text.ForeColor = Color.Red; text.Text = \"hello\"; text.TextAlign = HorizontalAlignment.Center; } Or maybe, using an ‚Äòaction delegate‚Äô, both options are correct: this.GetControls\u003cTextBox\u003e().ForEach(p =\u003e { p.BackColor = Color.LightGray; p.ForeColor = Color.Red; p.Text = \"hello\"; p.TextAlign = HorizontalAlignment.Center; }); Happy coding! :-) November 2010 ","date":"2010-11-09","objectID":"/retrieve-all-controls-using-generics-i/:1:2","tags":["csharp","net framework","generics"],"title":"Retrieve all controls using generics (I)","uri":"/retrieve-all-controls-using-generics-i/"}]